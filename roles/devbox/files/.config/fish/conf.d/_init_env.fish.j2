{% for entry in devbox_shell.env %}
set -gx {{ entry.name }} {{ entry.value }}
{% endfor %}

if test -d /opt/homebrew
  /opt/homebrew/bin/brew shellenv | source
end

if type -q mise
  mise activate fish | source
end

# Toolchain caches: redirect to sandbox-writable paths inside Claude Code
if set -q CLAUDECODE
  set -gx GOCACHE "$TMPDIR/go-build-cache"
  set -gx GOMODCACHE "$TMPDIR/go-mod-cache"
  set -gx UV_CACHE_DIR "$TMPDIR/uv-cache"
  set -gx RUFF_CACHE_DIR "$TMPDIR/ruff-cache"
  set -gx MYPY_CACHE_DIR "$TMPDIR/mypy-cache"
  set -gx NPM_CONFIG_CACHE "$TMPDIR/npm-cache"
end
