---
- name: "Install Homebrew apps"
  community.general.homebrew:
    name:
      - kitty
      - fish
      - fisher
      - bat
      - podman
      - mas
      - wget
      - curl
      - htop
      - nvim
      - telnet
    state: present

- name: "Install fontconfig (ignore post-install warnings)"
  community.general.homebrew:
    name:
      - fontconfig
    state: present
  register: fontconfig_result
  failed_when:
    - fontconfig_result.failed is defined
    - fontconfig_result.failed
    - '"post-install" not in fontconfig_result.msg'

- name: "Install Homebrew casks"
  community.general.homebrew_cask:
    name:
      - ghostty
      - font-fira-code
      - font-ia-writer-duo
      - font-ia-writer-mono
      - font-ia-writer-quattro
      - font-meslo-for-powerlevel10k
      - font-meslo-for-powerline
      - font-meslo-lg
      - font-meslo-lg-dz
      - font-meslo-lg-nerd-font
    state: present
    install_options: 'adopt'
    upgrade_all: false
  register: cask_primary_result
  failed_when:
    - cask_primary_result.failed is defined
    - cask_primary_result.failed
    - '"already installed" not in cask_primary_result.msg'
